# AI åŠ©æ‰‹ ID ä¸€è‡´æ€§æ–¹æ¡ˆå®æ–½æ€»ç»“

## âœ… é—®é¢˜å·²è§£å†³

å¯Œæ–‡æœ¬ç¬”è®°ç‚¹å‡»ååŠ©æ‰‹æ— æ³•è‡ªåŠ¨åˆ‡æ¢çš„é—®é¢˜å·²æˆåŠŸä¿®å¤ï¼

## ğŸ¯ å®æ–½æ–¹æ¡ˆ

### 1. åˆ›å»ºç»Ÿä¸€é…ç½®æ–‡ä»¶

#### åç«¯é…ç½®
**æ–‡ä»¶**: `packages/backend/prisma/assistants.config.ts`

å®šä¹‰äº†æ‰€æœ‰å†…ç½®åŠ©æ‰‹çš„ç»Ÿä¸€é…ç½®ï¼ŒåŒ…æ‹¬ï¼š
- åŠ©æ‰‹ IDï¼ˆå…¨å±€å”¯ä¸€ï¼‰
- åç§°ã€æè¿°ã€ç³»ç»Ÿæç¤ºè¯
- å¤´åƒã€æ¨¡å‹å‚æ•°
- æ’åºã€æ¿€æ´»çŠ¶æ€

#### å‰ç«¯é…ç½®
**æ–‡ä»¶**: `packages/frontend/src/config/assistants.config.ts`

ä¸åç«¯é…ç½®å®Œå…¨åŒæ­¥ï¼Œç¡®ä¿å‰ç«¯ä½¿ç”¨ç›¸åŒçš„åŠ©æ‰‹ IDã€‚

### 2. ç»Ÿä¸€çš„åŠ©æ‰‹ ID åˆ—è¡¨

| åŠ©æ‰‹ | ID | ç”¨é€” | æ–‡ä»¶ç±»å‹æ˜ å°„ |
|------|-----|------|-------------|
| é€šç”¨åŠ©æ‰‹ | `general_public` | é€šç”¨é—®ç­” | - |
| **å†™ä½œåŠ©æ‰‹** | `writing_public` | Markdown/å¯Œæ–‡æœ¬ | âœ… richtext â†’ writing_public |
| æ€»ç»“åŠ©æ‰‹ | `summary_public` | å†…å®¹æ€»ç»“ | - |
| ç¿»è¯‘åŠ©æ‰‹ | `translation_public` | å¤šè¯­è¨€ç¿»è¯‘ | - |
| **ä»£ç åŠ©æ‰‹** | `coding_public` | ä»£ç ç¬”è®° | âœ… monaco â†’ coding_public |
| **æ€ç»´å¯¼å›¾åŠ©æ‰‹** | `mindmap` | æ€ç»´å¯¼å›¾ | âœ… mindmap â†’ mindmap |
| **DrawIO åŠ©æ‰‹** | `drawio` | æµç¨‹å›¾ | âœ… drawio â†’ drawio |

### 3. æ–‡ä»¶ç±»å‹æ˜ å°„é…ç½®

```typescript
export const FILE_TYPE_ASSISTANT_MAP: Record<string, string> = {
  markdown: "writing_public",    // âœ… å†™ä½œåŠ©æ‰‹
  richtext: "writing_public",    // âœ… å†™ä½œåŠ©æ‰‹
  monaco: "coding_public",       // âœ… ä»£ç åŠ©æ‰‹
  mindmap: "mindmap",            // âœ… æ€ç»´å¯¼å›¾åŠ©æ‰‹
  drawio: "drawio",              // âœ… DrawIO åŠ©æ‰‹
};
```

### 4. æ›´æ–°çš„æ–‡ä»¶

#### åç«¯
1. **æ–°å¢**: `packages/backend/prisma/assistants.config.ts`
   - ç»Ÿä¸€çš„åŠ©æ‰‹é…ç½®å®šä¹‰

2. **æ–°å¢**: `packages/backend/prisma/seed-unified-assistants.ts`
   - æ•°æ®åº“åŒæ­¥è„šæœ¬
   - åˆ›å»º/æ›´æ–°æ‰€æœ‰å†…ç½®åŠ©æ‰‹åˆ° PostgreSQL

3. **ä¿ç•™**: `packages/backend/prisma/seed-public-assistants.ts`
   - åŸæœ‰çš„å…¬æœ‰åŠ©æ‰‹è„šæœ¬ï¼ˆå·²åºŸå¼ƒï¼Œä½¿ç”¨æ–°è„šæœ¬ï¼‰

#### å‰ç«¯
1. **æ–°å¢**: `packages/frontend/src/config/assistants.config.ts`
   - å‰ç«¯åŠ©æ‰‹é…ç½®ï¼ˆä¸åç«¯åŒæ­¥ï¼‰

2. **æ›´æ–°**: `packages/frontend/src/db/index.ts`
   - IndexedDB åˆå§‹åŒ–æ—¶ä½¿ç”¨ç»Ÿä¸€é…ç½®
   - ç§»é™¤ç¡¬ç¼–ç çš„åŠ©æ‰‹åˆ—è¡¨

3. **æ›´æ–°**: `packages/frontend/src/components/Note/NoteEditor.tsx`
   - ä½¿ç”¨ `FILE_TYPE_ASSISTANT_MAP` é…ç½®
   - ç§»é™¤ç¡¬ç¼–ç çš„åŠ©æ‰‹ ID

### 5. æ•°æ®åº“åŒæ­¥ç»“æœ

```
âœ… åŠ©æ‰‹æ•°æ®åŒæ­¥å®Œæˆï¼
   - æ–°åˆ›å»º: 3 ä¸ª
   - å·²æ›´æ–°: 4 ä¸ª
   - æ€»è®¡: 7 ä¸ªå†…ç½®åŠ©æ‰‹

ğŸ“‹ å½“å‰å†…ç½®åŠ©æ‰‹åˆ—è¡¨:
1. ğŸ¤– é€šç”¨åŠ©æ‰‹ (ID: general_public)
2. âœï¸ å†™ä½œåŠ©æ‰‹ (ID: writing_public) âœ…
3. ğŸ“ æ€»ç»“åŠ©æ‰‹ (ID: summary_public)
4. ğŸŒ ç¿»è¯‘åŠ©æ‰‹ (ID: translation_public)
5. ğŸ’» ä»£ç åŠ©æ‰‹ (ID: coding_public) âœ…
6. ğŸ§  æ€ç»´å¯¼å›¾åŠ©æ‰‹ (ID: mindmap) âœ…
7. ğŸ“Š DrawIO ç»˜å›¾åŠ©æ‰‹ (ID: drawio) âœ…
```

## ğŸ”„ æ•°æ®åŒæ­¥æµç¨‹

```
1. PostgreSQL (æƒå¨æ•°æ®æº)
   â†“
2. å‰ç«¯é€šè¿‡ API (/api/v1/ai/assistants) åŠ è½½
   â†“
3. ç¼“å­˜åˆ° IndexedDB (æœ¬åœ°ç¼“å­˜)
   â†“
4. NoteEditor ä½¿ç”¨ FILE_TYPE_ASSISTANT_MAP è‡ªåŠ¨åˆ‡æ¢
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŒæ­¥æ•°æ®åº“åŠ©æ‰‹

```bash
cd packages/backend
npx tsx prisma/seed-unified-assistants.ts
```

### éªŒè¯

1. æ‰“å¼€ AiNote åº”ç”¨
2. ç‚¹å‡»å¯Œæ–‡æœ¬ç¬”è®°
3. è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ï¼š
   ```
   [NoteEditor] å·²è‡ªåŠ¨åˆ‡æ¢åˆ°å†™ä½œåŠ©æ‰‹åŠ©æ‰‹ (ID: writing_public)
   ```
4. AI åŠ©æ‰‹é¢æ¿åº”æ˜¾ç¤º"âœï¸ å†™ä½œåŠ©æ‰‹"

## ğŸ“ ç»´æŠ¤æŒ‡å—

### æ·»åŠ æ–°çš„å†…ç½®åŠ©æ‰‹

1. æ›´æ–° `packages/backend/prisma/assistants.config.ts`
2. æ›´æ–° `packages/frontend/src/config/assistants.config.ts`
3. å¦‚éœ€æ–‡ä»¶ç±»å‹æ˜ å°„ï¼Œæ›´æ–° `FILE_TYPE_ASSISTANT_MAP`
4. è¿è¡ŒåŒæ­¥è„šæœ¬ï¼š`npx tsx prisma/seed-unified-assistants.ts`
5. åˆ·æ–°å‰ç«¯é¡µé¢

### ä¿®æ”¹ç°æœ‰åŠ©æ‰‹é…ç½®

1. ä¿®æ”¹ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼ˆä¿æŒåŒæ­¥ï¼‰
2. è¿è¡ŒåŒæ­¥è„šæœ¬ï¼ˆä¼šè‡ªåŠ¨æ›´æ–°å·²å­˜åœ¨çš„åŠ©æ‰‹ï¼‰
3. åˆ·æ–°å‰ç«¯é¡µé¢

## ğŸ‰ æˆæœ

1. âœ… **ç»Ÿä¸€é…ç½®**ï¼šæ‰€æœ‰åŠ©æ‰‹ ID åœ¨å‰åç«¯ä¿æŒä¸€è‡´
2. âœ… **è‡ªåŠ¨åŒ–åŒæ­¥**ï¼šæ•°æ®åº“åŒæ­¥è„šæœ¬è‡ªåŠ¨åˆ›å»º/æ›´æ–°åŠ©æ‰‹
3. âœ… **ç±»å‹å®‰å…¨**ï¼šTypeScript ç±»å‹å®šä¹‰ç¡®ä¿é…ç½®æ­£ç¡®
4. âœ… **æ˜“äºç»´æŠ¤**ï¼šé›†ä¸­ç®¡ç†åŠ©æ‰‹é…ç½®ï¼Œä¿®æ”¹ä¸€å¤„å³å¯
5. âœ… **æ–‡æ¡£å®Œå–„**ï¼šæä¾›åŒæ­¥æŒ‡å—å’Œæ•…éšœæ’æŸ¥æ–¹æ³•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [SYNC_ASSISTANTS.md](./SYNC_ASSISTANTS.md) - è¯¦ç»†çš„åŒæ­¥æŒ‡å—å’Œæ•…éšœæ’æŸ¥

---

**å®æ–½æ—¥æœŸ**: 2026-01-06
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶éªŒè¯
**ä½œè€…**: Claude Code
