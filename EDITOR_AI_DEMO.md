# 编辑器与 AI 助手集成功能演示

## 功能演示流程

### 场景 1：思维导图节点 → AI 助手

```
┌─────────────────────────────────────────────────────────────────┐
│                     MindMap 编辑器                              │
├─────────────────────────────────────────────────────────────────┤
│  [删除] [📤 发送 3 个节点] [复制] [剪切] [粘贴] [撤销] [重做]   │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│                    📍 项目规划                                   │
│                      /          \                                │
│           ├─ 需求分析            ├─ 技术设计                      │
│           /     \               /      \                         │
│      用户调研  竞品分析      架构设计  数据库设计                  │
│                                                                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              ↓ 点击发送按钮
┌─────────────────────────────────────────────────────────────────┐
│                     AI 助手                                     │
├─────────────────────────────────────────────────────────────────┤
│  🤖 通用助手         [新建对话] [⚙️ 设置] [⋮ 更多]              │
├─────────────────────────────────────────────────────────────────┤
│  [对话历史...]                                                   │
├─────────────────────────────────────────────────────────────────┤
│  📋 已选择 3 个思维导图节点                                [清除]│
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ 📍 项目规划                                                │  │
│  │   ├─ 需求分析                                              │  │
│  │   └─ 技术设计                                              │  │
│  └───────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ 请帮我分析这个思维导图的结构...                           │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                           [清空] [发送]         │
└─────────────────────────────────────────────────────────────────┘
```

### 场景 2：Markdown 文本选择 → AI 助手

```
┌─────────────────────────────────────────────────────────────────┐
│                     Markdown 编辑器                             │
├─────────────────────────────────────────────────────────────────┤
│  # 项目计划                                                      │
│                                                                  │
│  ## 目标                                                         │
│  ┌─────────────────────────────────┐                            │
│  │本项目旨在开发一个智能笔记系统，│  ← 鼠标选中这段文本          │
│  │支持多格式编辑和 AI 集成。       │                            │
│  └─────────────────────────────────┘                            │
│                                                                  │
│  ## 功能模块                                                    │
└─────────────────────────────────────────────────────────────────┘
                              ↓ 自动检测选择
┌─────────────────────────────────────────────────────────────────┐
│                     AI 助手                                     │
├─────────────────────────────────────────────────────────────────┤
│  🤖 写作助手         [新建对话] [⚙️ 设置] [⋮ 更多]              │
├─────────────────────────────────────────────────────────────────┤
│  📋 已选择 Markdown 内容: "本项目旨在开发..."            [清除]│
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ 请帮我润色这段文字...                                     │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                           [清空] [发送]         │
└─────────────────────────────────────────────────────────────────┘
```

### 场景 3：DrawIO 元素选择 → AI 助手

```
┌─────────────────────────────────────────────────────────────────┐
│                     DrawIO 编辑器                               │
├─────────────────────────────────────────────────────────────────┤
│  [📤 发送 2 个元素]                                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│    ┌─────────┐                                                  │
│    │ 开始    │                                                  │
│    └────┬────┘                                                  │
│         │                                                        │
│         ▼                                                        │
│    ┌─────────┐     ← 选中这两个元素                             │
│    │ 处理    │                                                  │
│    └─────────┘                                                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
                              ↓ 点击发送按钮
┌─────────────────────────────────────────────────────────────────┐
│                     AI 助手                                     │
├─────────────────────────────────────────────────────────────────┤
│  🤖 编程助手         [新建对话] [⚙️ 设置] [⋮ 更多]              │
├─────────────────────────────────────────────────────────────────┤
│  📋 已选择 DrawIO 的 2 个元素                            [清除]│
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ [1] 开始 (起点)                                            │  │
│  │ [2] 处理 (矩形)                                            │  │
│  └───────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ 请解释这个流程图...                                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                           [清空] [发送]         │
└─────────────────────────────────────────────────────────────────┘
```

### 场景 4：用户配置设置

```
┌─────────────────────────────────────────────────────────────────┐
│                    选择内容设置                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  发送模式                                                        │
│  ◉ 文本模式（推荐）                                              │
│    发送格式化后的文本，节省 Token，易于理解                      │
│  ○ JSON 模式                                                    │
│    发送完整的结构化数据，包含所有元数据                          │
│  ○ 混合模式                                                     │
│    同时发送文本和 JSON，AI 可以选择使用哪个                      │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  最大节点数量                ━━━━━●━━━━━━━━━━━━━          20 个   │
│  限制单次选择的节点数量，避免消耗过多 Token                      │
│                                                                  │
│  最大文本长度                ━━━━━━━━●━━━━━━━━━━           2.0K   │
│  选择文本时的最大字符数，超出部分将被截断                        │
│                                                                  │
│  ─────────────────────────────────────────────────────────────  │
│                                                                  │
│  其他选项                                                        │
│  ┌─────────────────────────────┐  显示预览        [🟢]         │
│  │ 发送后自动清除              │  发送后自动清除   [🟢]         │
│  └─────────────────────────────┘                                │
│                                                                  │
│                                           [取消]         [完成]   │
└─────────────────────────────────────────────────────────────────┘
```

## 核心价值

### 1. 提升效率
- **无需复制粘贴**：选中即发送，省去手动复制的步骤
- **批量处理**：一次选择多个节点，批量提问

### 2. 智能交互
- **结构化数据**：AI 理解节点层级关系，提供更精准的回答
- **上下文保留**：选择内容附加到对话中，AI 理解更完整

### 3. 用户友好
- **视觉反馈**：清晰的选择状态指示
- **灵活配置**：根据个人需求调整行为

## 典型使用场景

### 场景 A：思维导图内容生成
```
用户：选中思维导图的 3 个分支节点
AI：请根据这些节点生成一份详细的文档
结果：AI 理解层级结构，生成格式化的文档
```

### 场景 B：代码审查
```
用户：在 Monaco 中选中一段代码
AI：请解释这段代码的作用，并指出潜在问题
结果：AI 分析代码逻辑，提供优化建议
```

### 场景 C：流程图优化
```
用户：选中 DrawIO 流程图的关键节点
AI：请分析这个流程是否存在逻辑漏洞
结果：AI 理解流程关系，指出可能的问题
```

### 场景 D：文档润色
```
用户：在富文本编辑器中选中一段文字
AI：请帮我润色这段文字，使其更加专业
结果：AI 保留原意，优化表达方式
```

## 技术特点

- ✅ **类型安全**：完整的 TypeScript 支持
- ✅ **跨编辑器**：统一的数据结构
- ✅ **性能优化**：智能截断，避免 Token 浪费
- ✅ **用户控制**：丰富的配置选项
- ✅ **持久化**：设置自动保存到本地
